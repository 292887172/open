<header class="header bg-light dk">
    <p>添加接口</p>
</header>
<section class="scrollable padder">
    <div class="row m-t">
        <div class="col-md-12">
            <form id="addApiForm" class="form-horizontal" data-validate="parsley">
                    <section class="panel panel-default">
                      <header class="panel-heading">
                        <strong>接口信息</strong>
                      </header>
                      <div class="panel-body">
                        <div class="form-group">
                          <label class="col-sm-2 control-label">名称</label>
                          <div class="col-sm-8">
                            <input type="text" ng-model="editApiFormData.api_name" class="form-control parsley-validated" data-minlength="6" data-required="true" placeholder="6个字符以上">
                          </div>
                        </div>
                        <div class="line line-dashed b-b line-lg pull-in"></div>
                        <div class="form-group">
                          <label class="col-sm-2 control-label">请求地址</label>
                          <div class="col-sm-8">
                            <input type="text" ng-model="editApiFormData.api_url" class="form-control parsley-validated" data-type="url" data-required="true" placeholder="请正确填写Url地址">
                          </div>
                        </div>
                        <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">请求方式</label>
                          <div class="col-sm-4">
                              <select data-required="true" class="form-control parsley-validated" ng-model="editApiFormData.api_request_type"
                                ng-options="t.value as t.name for t in apiMethedSelectItems">
                            </select>
                          </div>
                        </div>
                        <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">接口类型</label>
                          <div class="col-sm-4">
                            <select data-required="true" class="form-control parsley-validated"
                                ng-options="t.value as t.name for t in apiTypeSelectItems" ng-model="editApiFormData.api_type">
                            </select>
                          </div>
                        </div>
                        <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">接口描述</label>
                          <div class="col-sm-8">
                              <textarea ng-model="editApiFormData.api_describe" class="form-control ng-pristine ng-valid ng-touched parsley-validated" data-required="true" id="remarkTextArea" rows="3" placeholder="请填写描述"></textarea>
                          </div>
                        </div>

                          <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">添加参数</label>
                          <div class="col-sm-8">
                              <ul id="params" class="list-group no-bg no-borders auto m-t-n-xxs">
                                  <li class="list-group-item">
                                      <div class="row">
                                          <div class="col-xs-2 text-center">名称</div>
                                          <div class="col-xs-2 text-center">类型</div>
                                          <div class="col-xs-2 text-center">示例值</div>
                                          <div class="col-xs-2 text-center">需要请勾选</div>
                                          <div class="col-xs-2 text-center">备注</div>
                                          <div class="col-xs-2"><input type="button" class="btn-param-add btn btn-xs btn-success" value="添加参数"/></div>
                                      </div>
                                  </li>
                              </ul>
                          </div>
                        </div>

                          <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">返回内容示例</label>
                          <div class="col-sm-8">
                              <textarea ng-model="editApiFormData.api_return" class="form-control ng-pristine ng-valid ng-touched parsley-validated" data-required="true" id="remarkTextArea" rows="3" placeholder="请填写返回内容"></textarea>
                          </div>
                        </div>

                          <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">文档地址</label>
                          <div class="col-sm-8">
                              <input type="text" ng-model="editApiFormData.api_doc_url" class="form-control parsley-validated" data-type="url" data-required="true" placeholder="请正确填写Url地址">
                          </div>
                        </div>

                        <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">无权限的指向链接</label>
                          <div class="col-sm-8">
                            <input type="text" ng-model="editApiFormData.api_action_url" class="form-control parsley-validated" data-type="url" data-required="true" placeholder="请正确填写Url地址">
                          </div>
                        </div>
                        <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">请求端口号</label>
                          <div class="col-sm-8">
                            <input type="text" ng-model="editApiFormData.api_port" class="form-control parsley-validated" data-type="digits" data-required="true" value="80" disabled placeholder="请填写端口号, 留空(默认80端口)">
                          </div>
                        </div>
                          <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">分类</label>
                          <div class="col-sm-4">
                            <select data-required="true" class="form-control parsley-validated" ng-model="editApiFormData.api_classify"
                                ng-options="t.value as t.name for t in apiClassifySelectItems">
                            </select>
                          </div>
                        </div>
                          <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">功能</label>
                          <div class="col-sm-4">
                            <select data-required="true" class="form-control parsley-validated" ng-model="editApiFormData.api_function"
                                    ng-options="t.value as t.name for t in apiFunctionSelectItems">
                            </select>
                          </div>
                        </div>
                          <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">权限等级</label>
                          <div class="col-sm-4">
                            <select data-required="true" class="form-control parsley-validated" ng-model="editApiFormData.api_level"
                                    ng-options="t.value as t.name for t in apiLevelSelectItems">
                            </select>
                          </div>
                        </div>
                          <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">分组</label>
                          <div class="col-sm-4">
                            <select data-required="true" class="form-control parsley-validated" ng-model="editApiFormData.api_group"
                                    ng-options="t.value as t.name for t in apiGroupSelectItems">
                            </select>
                          </div>
                        </div>
                          <div class="line line-dashed b-b line-lg pull-in"></div>
                          <div class="form-group">
                          <label class="col-sm-2 control-label">每日调用次数上限</label>
                          <div class="col-sm-4">
                            <input type="text" ng-model="editApiFormData.api_invoke_total" class="form-control parsley-validated" data-type="digits" data-required="true" value="0" placeholder="请填写整数, 0 为无上限">
                          </div>
                        </div>
                      </div>
                      <footer class="panel-footer text-right bg-light lter">
                          <button type="button" onclick="location.reload()" class="btn btn-default btn-s-xs">取消</button>&nbsp;
                        <button type="submit" class="btn btn-success btn-s-xs" ng-click="submitApiForm()">提交</button>
                      </footer>
                    </section>
                  </form>
        </div>
    </div>
</section>
<script src="/static/common/js/parsley/parsley.min.js"></script>
<script src="/static/common/js/parsley/parsley.extend.js"></script>
<script src="/static/js/common/template-native.js"></script>
<script type="text/html" id="params_template">
    <%for (var i=0;i<list.length;i++) {%>
        <li class="list-group-item api-params">
          <div class="row">
              <div class="col-xs-2"><input type="text" class="form-control parsley-validated param-name" data-required="true" placeholder="" value="<%=list[i].name%>"></div>
              <div class="col-xs-2">
                  <select data-required="true" class="form-control parsley-validated param-type" ng-value="<%=list[i].type%>" >
                      <option value="" selected="selected" label="请选择">请选择</option>
                      <option value="string" label="String">String</option>
                      <option value="integer" label="Integer">Integer</option>
                      <option value="float" label="Float">Float</option>
                      <option value="boole" label="boole">Boole</option>
                  </select>
              </div>
              <div class="col-xs-2"><input type="text" class="form-control parsley-validated param-example" data-required="true" placeholder="" value="<%=list[i].example%>"></div>
              <div class="col-xs-2 text-center"><input type="checkbox" class="param-required"/> (是/否)</div>
              <div class="col-xs-2"><input type="text" class="form-control parsley-validated param-remark" data-required="true" placeholder="" value="<%=list[i].remark%>"></div>
              <div class="col-xs-2"><input type="button" class="btn-param-remove btn btn-xs btn-danger" value="删除"/></div>
          </div>
        </li>
    <%}%>
</script>
<script type="text/html" id="param">
<li class="list-group-item api-params">
  <div class="row">
      <div class="col-xs-2"><input type="text" class="form-control parsley-validated param-name" data-required="true" placeholder="" value=""></div>
      <div class="col-xs-2">
          <select data-required="true" class="form-control parsley-validated param-type">
              <option value="" selected="selected" label="请选择">请选择</option>
              <option value="string" label="String">String</option>
              <option value="integer" label="Integer">Integer</option>
              <option value="float" label="Float">Float</option>
              <option value="boole" label="boole">Boole</option>
          </select>
      </div>
      <div class="col-xs-2"><input type="text" class="form-control parsley-validated param-example" data-required="true" placeholder=""></div>
      <div class="col-xs-2 text-center"><input type="checkbox" class="param-required"/> (是/否)</div>
      <div class="col-xs-2"><input type="text" class="form-control parsley-validated param-remark" data-required="true" placeholder=""></div>
      <div class="col-xs-2"><input type="button" class="btn-param-remove btn btn-xs btn-danger" value="删除"/></div>
  </div>
</li>
</script>
<script type="text/javascript">
    var body = $("body");
    body.delegate(".btn-param-add", "click", function () {
        $("#params").append($("#param").html());
    });
    body.delegate(".btn-param-remove", "click", function () {
        $(this).parent().parent().parent().remove();
    });
  $('#addApiForm').parsley();
</script>