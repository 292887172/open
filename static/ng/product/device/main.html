<style>
    #no-info{
        display: none;
        top: 108px;
        position: relative;
        left: 300px;
    }
    .row{
        margin-right: -14px;
    position: relative;
    left: 585px;
    top: 45px;
    }
</style>
<script src="/static/assets/js/jquery-2.1.4.min.js"></script>
<script src="/static/js/ejs.js"></script>
<script type="text/javascript">
    jQuery(function($) {
        var device_list={};
        $.ajax({
            url: location.href,
            type: "POST",
            data: {'device': 'device_table'},
            success: function (data) {

                device_list= data['data'];
                if(! device_list){
                    $("#device-info").css("display","none");
                    $("#barcon").css("display","none");
                    $("#no-info").css("display","block");
                 }
                load_table(device_list);
            },
            error: function (e) {
                alert(e)
            }
        });
        function load_table(device_list) {
            group = new EJS({url: '/static/js/tmpl/device_table.ejs'}).render({"device_list":device_list});
            document.getElementById("device-info").innerHTML=group;
            goPage(1,10);
            // 分页显示
        }

    });
    function goPage(pno,psize) {
            var itable = document.getElementById("table-device");
            var num = itable.rows.length;//表格所有行数(所有记录数)
            console.log(num);
            var totalPage = 0;//总页数
            var pageSize = psize;//每页显示行数
            //总共分几页
            if (num / pageSize > parseInt(num / pageSize)) {
                totalPage = parseInt(num / pageSize) + 1;
            } else {
                totalPage = parseInt(num / pageSize);
            }
            var currentPage = pno;//当前页数
            var startRow = (currentPage - 1) * pageSize + 1;//开始显示的行  31
            var endRow = currentPage * pageSize;//结束显示的行   40
            endRow = (endRow > num) ? num : endRow;
            console.log(endRow);
            //遍历显示数据实现分页
            for (var i = 1; i < (num + 1); i++) {
                var irow = itable.rows[i - 1];
                if (i >= startRow && i <= endRow) {
                    irow.style.display = "";
                } else {
                    irow.style.display = "none";
                }
            }
            var pageEnd = document.getElementById("pageEnd");
            var tempStr = "共" + num + "条记录 分" + totalPage + "页 当前第" + currentPage + "页";
            if (currentPage > 1) {
                tempStr += "<a  onclick=\"goPage(" + (1) + "," + psize + ")\">首页</a>";
                tempStr += "<a onclick=\"goPage(" + (currentPage - 1) + "," + psize + ")\"><上一页</a>"
            } else {
                tempStr += "首页";
                tempStr += "<上一页";
            }

            if (currentPage < totalPage) {
                tempStr += "<a type='a' onclick=\"goPage(" + (currentPage + 1) + "," + psize + ")\">下一页></a>";
                tempStr += "<a type='a' onclick=\"goPage(" + (totalPage) + "," + psize + ")\">尾页</a>";
            } else {
                tempStr += "下一页>";
                tempStr += "尾页";
            }
            document.getElementById("barcon").innerHTML = tempStr;
        }

</script>

<div class="box2 relative">
    <div class="hl-help">
        <span class="linkBlue">设备管理中心</span>
    </div>
	<div class="mt20">
        <div class="boxInfo">
            <h3 class="tit5">设备管理表</h3>
                <h3 class="tit5" id="no-info" >暂无设备管理表信息</h3>
                <div class="panel panel-default" id="device-info" >
                </div>
                <div class="row" id="barcon">
                 </div>
        </div>
    </div>
</div>
<script>
</script>
